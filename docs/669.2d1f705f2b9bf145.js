"use strict";(self.webpackChunkportal=self.webpackChunkportal||[]).push([[669],{7669:(v,c,s)=>{s.r(c),s.d(c,{ClientUserModule:()=>x});var n=s(9808),l=s(1083),u=s(8933),m=s(9319),a=s(3075),f=s(9525),e=s(5e3),g=s(5343),C=s(7990),y=s(2290),p=s(7093),b=s(6928),F=s(7423);function O(i,r){if(1&i&&(e.ynx(0),e._UZ(1,"app-dynamic-form-field",5),e.BQk()),2&i){const t=r.$implicit;e.xp6(1),e.Q6J("formItem",t)}}let h=(()=>{class i{constructor(t,o,d,P,S,G,Y){this.fb=t,this.clientUserService=o,this.listOfValuesService=d,this.activeRoute=P,this.toastr=S,this.router=G,this.cdref=Y,this.cities=[]}ngOnInit(){this.getIdFromUrl(),this.createForm(),this.tracCountryChange()}createDynamicFormFields(){this.dynamicFormFields=[{id:"clientId",label:"Company",type:"select",selectMenuOptions:this.Client,defaultValue:{value:"",disabled:!1},validators:[a.kI.required]},{id:"name",label:"Name",type:"text",defaultValue:{value:"",disabled:!1},validators:[a.kI.required]},{id:"email",label:"Email",type:"text",defaultValue:{value:"",disabled:!1},validators:[a.kI.required,a.kI.email]},{id:"username",label:"Username",type:"text",defaultValue:{value:"",disabled:!1},validators:[a.kI.required]},{id:"password",label:"Password",type:"password",defaultValue:{value:"",disabled:!1},validators:[a.kI.required]},{id:"phone",label:"Phone",type:"text",defaultValue:{value:"",disabled:!1}},{id:"genderId",label:"Gender",type:"select",selectMenuOptions:this.Gender,defaultValue:{value:"",disabled:!1},validators:[a.kI.required]},{id:"countryId",label:"Country",type:"select",selectMenuOptions:this.Country,defaultValue:{value:"",disabled:!1},validators:[a.kI.required]},{id:"cityId",label:"City",type:"select",selectMenuOptions:this.cities,defaultValue:{value:"",disabled:!1},validators:[a.kI.required]}]}getIdFromUrl(){this.id=this.activeRoute.snapshot.paramMap.get("id"),this.id?(this.formMode=f.h.Edit,this.getItemById(this.id)):this.formMode=f.h.Add}get Client(){let t=[];return this.listOfValuesService.getClients().subscribe(o=>{t.push(...o)}),t}get Gender(){let t=[];return this.listOfValuesService.getGender().subscribe(o=>{t.push(...o)}),t}get Country(){let t=[];return this.listOfValuesService.getCountries().subscribe(o=>{t.push(...o)}),t}tracCountryChange(){var t;null===(t=this.myForm.get("countryId"))||void 0===t||t.valueChanges.subscribe(o=>{var d;null===(d=this.myForm.get("cityId"))||void 0===d||d.setValue(""),this.cities.length=0,this.getCities(o),this.cdref.detectChanges()})}getCities(t){this.listOfValuesService.getCities(t).subscribe(o=>{this.cities.push(...o)})}createForm(){this.createDynamicFormFields(),this.myForm=this.fb.group({}),this.dynamicFormFields.forEach(t=>{const o=this.fb.control(Object.assign({},t.defaultValue),t.validators);this.myForm.addControl(t.id,o)})}getItemById(t){this.clientUserService.get(t).subscribe(o=>{this.myForm.patchValue(o)})}saveData(){if(this.myForm.invalid)return;let t=this.myForm.value;this.formMode===f.h.Add?this.addCertificate(t):(t=Object.assign(Object.assign({},t),{id:this.id}),this.updateCertificate(t))}addCertificate(t){this.clientUserService.add(t).subscribe(()=>{this.actionAfterAddOrUpdate("added")})}updateCertificate(t){this.clientUserService.update(t).subscribe(()=>{this.actionAfterAddOrUpdate("updated")})}actionAfterAddOrUpdate(t){this.myForm.reset("",{emitEvent:!1}),this.toastr.success(`User ${t} successfully`),this.router.navigate(["/client-user"])}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(a.qu),e.Y36(g.s),e.Y36(C.j),e.Y36(l.gz),e.Y36(y._W),e.Y36(l.F0),e.Y36(e.sBO))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-control"]],decls:6,vars:4,consts:[[1,"wrap-form"],["fxLayout","column","fxLayoutGap","0px",1,"form",3,"formGroup"],[4,"ngFor","ngForOf"],[1,"form-buttons"],["mat-button","","type","button",3,"disabled","click"],[3,"formItem"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"form",1),e.YNc(2,O,2,1,"ng-container",2),e.TgZ(3,"div",3)(4,"button",4),e.NdJ("click",function(){return o.saveData()}),e._uU(5),e.qZA()()()()),2&t&&(e.xp6(1),e.Q6J("formGroup",o.myForm),e.xp6(1),e.Q6J("ngForOf",o.dynamicFormFields),e.xp6(2),e.Q6J("disabled",o.myForm.invalid),e.xp6(1),e.hij(" ",o.formMode," "))},directives:[a._Y,a.JL,p.xw,p.SQ,a.sg,n.sg,b.q,F.lW],styles:[".wrap-form[_ngcontent-%COMP%]{margin-block:3rem}.wrap-form[_ngcontent-%COMP%]   .form[_ngcontent-%COMP%]{width:80%;margin:0 auto}.wrap-form[_ngcontent-%COMP%]   .form-buttons[_ngcontent-%COMP%]   .mat-button[_ngcontent-%COMP%]{padding:5px;border-radius:10px;background-color:#454545;color:#ffe5e5}.wrap-form[_ngcontent-%COMP%]   .form-buttons[_ngcontent-%COMP%]   .mat-button[disabled][_ngcontent-%COMP%]{background-color:#707070}"]}),i})();const U=[{path:"",component:s(1299).u,canActivate:[u.W],data:{role:[m.G.Admin]}},{path:"create",component:h,canActivate:[u.W],data:{role:[m.G.Admin]}},{path:"edit/:id",component:h,canActivate:[u.W],data:{role:[m.G.Admin]}},{path:"profile",component:(()=>{class i{constructor(){}ngOnInit(){}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-profile"]],decls:2,vars:0,template:function(t,o){1&t&&(e.TgZ(0,"p"),e._uU(1,"user profile works!"),e.qZA())},styles:[""]}),i})(),canActivate:[u.W],data:{role:[m.G.User]}}];let A=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[l.Bz.forChild(U)],l.Bz]}),i})();var V=s(6213);let x=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[n.ez,A,V.m]]}),i})()},9525:(v,c,s)=>{s.d(c,{h:()=>n});var n=(()=>{return(l=n||(n={})).Add="Add",l.Edit="Update",n;var l})()}}]);